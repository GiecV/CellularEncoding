

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>core.genome &mdash; Cellular Encoding 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=01f34227"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Cellular Encoding
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">Modules</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Cellular Encoding</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">core.genome</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for core.genome</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">treelib</span> <span class="kn">import</span> <span class="n">Tree</span>
<span class="kn">from</span> <span class="nn">utils.counter</span> <span class="kn">import</span> <span class="n">GlobalCounter</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">pickle</span>


<div class="viewcode-block" id="Genome">
<a class="viewcode-back" href="../../core.html#core.genome.Genome">[docs]</a>
<span class="k">class</span> <span class="nc">Genome</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a genome consisting of multiple trees. The nodes are operations to be performed on a neural network (NN).</span>

<span class="sd">    The Genome class manages a collection of trees, allowing for operations such as symbol changes, subtree retrieval,</span>
<span class="sd">    and printing of tree structures. It provides methods to manipulate and access the genetic information represented </span>
<span class="sd">    in the trees.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trees</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">parents</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes a genome with a specified number of trees or uses provided trees.</span>

<span class="sd">        This constructor sets up the genome&#39;s tree structure. If no trees are provided, it creates a default set of </span>
<span class="sd">        trees, each initialized with a single gene node.</span>

<span class="sd">        :param trees: A list of trees to initialize the genome with. Defaults to None.</span>
<span class="sd">        :type trees: list, optional</span>
<span class="sd">        :param parents: A parameter to specify parent relationships. Defaults to None.</span>
<span class="sd">        :type parents: list, optional</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">LEVELS</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># How many trees to consider</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">STARTING_SYMBOL</span> <span class="o">=</span> <span class="s2">&quot;e&quot;</span>  <span class="c1"># Each newborn gene will start with the end symbol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TERMINAL_SYMBOLS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;n&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DIVISION_SYMBOLS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">OPERATIONAL_SYMBOLS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;i&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">SYMBOLS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TERMINAL_SYMBOLS</span> <span class="o">+</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">DIVISION_SYMBOLS</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">OPERATIONAL_SYMBOLS</span>

        <span class="k">if</span> <span class="n">trees</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_trees</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LEVELS</span><span class="p">):</span>  <span class="c1"># Create the trees with a single gene</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_trees</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Tree</span><span class="p">())</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_trees</span><span class="p">[</span><span class="n">level</span><span class="p">]</span><span class="o">.</span><span class="n">create_node</span><span class="p">(</span>
                    <span class="n">tag</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">STARTING_SYMBOL</span><span class="p">,</span>
                    <span class="n">identifier</span><span class="o">=</span><span class="n">GlobalCounter</span><span class="o">.</span><span class="n">next</span><span class="p">(),</span>
                    <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LEVELS</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">trees</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_trees</span> <span class="o">=</span> <span class="n">trees</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">parents</span> <span class="o">=</span> <span class="n">parents</span>

<div class="viewcode-block" id="Genome.change_symbol">
<a class="viewcode-back" href="../../core.html#core.genome.Genome.change_symbol">[docs]</a>
    <span class="k">def</span> <span class="nf">change_symbol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">node_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">symbol</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Changes the symbol of a specified gene and creates child nodes as necessary.</span>

<span class="sd">        This method updates the symbol of a gene at a given level and node ID. If the new symbol is not terminal, </span>
<span class="sd">        it creates additional child nodes based on the symbol type, ensuring the tree structure remains valid.</span>

<span class="sd">        :param level: The level of the tree where the gene is located.</span>
<span class="sd">        :type level: int</span>
<span class="sd">        :param node_id: The identifier of the node whose symbol is to be changed.</span>
<span class="sd">        :type node_id: str</span>
<span class="sd">        :param symbol: The new symbol to assign to the gene.</span>
<span class="sd">        :type symbol: str</span>
<span class="sd">        :raises ValueError: If the provided symbol is not valid.</span>
<span class="sd">        :example: </span>
<span class="sd">            &gt;&gt;&gt; genome.change_symbol(0, &quot;node0&quot;, &quot;w&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">symbol</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SYMBOLS</span> <span class="ow">and</span> <span class="n">symbol</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">OPERATIONAL_SYMBOLS</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid symbol: </span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_trees</span><span class="p">[</span><span class="n">level</span><span class="p">]</span><span class="o">.</span><span class="n">update_node</span><span class="p">(</span><span class="n">nid</span><span class="o">=</span><span class="n">node_id</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">symbol</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">symbol</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">TERMINAL_SYMBOLS</span><span class="p">:</span>
            <span class="n">end_symbol</span> <span class="o">=</span> <span class="s1">&#39;e&#39;</span> <span class="k">if</span> <span class="n">level</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="s1">&#39;n&#39;</span>
        <span class="c1"># if symbol not in self.TERMINAL_SYMBOLS:</span>
        <span class="c1">#     end_symbol = &#39;e&#39;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_trees</span><span class="p">[</span><span class="n">level</span><span class="p">]</span><span class="o">.</span><span class="n">create_node</span><span class="p">(</span>
                <span class="n">tag</span><span class="o">=</span><span class="n">end_symbol</span><span class="p">,</span>
                <span class="n">identifier</span><span class="o">=</span><span class="n">GlobalCounter</span><span class="o">.</span><span class="n">next</span><span class="p">(),</span>
                <span class="n">parent</span><span class="o">=</span><span class="n">node_id</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">DIVISION_SYMBOLS</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_trees</span><span class="p">[</span><span class="n">level</span><span class="p">]</span><span class="o">.</span><span class="n">create_node</span><span class="p">(</span>
                    <span class="n">tag</span><span class="o">=</span><span class="n">end_symbol</span><span class="p">,</span>
                    <span class="n">identifier</span><span class="o">=</span><span class="n">GlobalCounter</span><span class="o">.</span><span class="n">next</span><span class="p">(),</span>
                    <span class="n">parent</span><span class="o">=</span><span class="n">node_id</span><span class="p">,</span>
                <span class="p">)</span></div>


<div class="viewcode-block" id="Genome.get_symbol">
<a class="viewcode-back" href="../../core.html#core.genome.Genome.get_symbol">[docs]</a>
    <span class="k">def</span> <span class="nf">get_symbol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">node_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the symbol of a specified gene from a given tree level.</span>

<span class="sd">        :param level: The level of the tree from which to retrieve the symbol.</span>
<span class="sd">        :type level: int</span>
<span class="sd">        :param node_id: The identifier of the node whose symbol is to be retrieved.</span>
<span class="sd">        :type node_id: str</span>
<span class="sd">        :return: The symbol of the specified gene.</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trees</span><span class="p">[</span><span class="n">level</span><span class="p">]</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="n">node_id</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span></div>


<div class="viewcode-block" id="Genome.print">
<a class="viewcode-back" href="../../core.html#core.genome.Genome.print">[docs]</a>
    <span class="k">def</span> <span class="nf">print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints the structure of the genome&#39;s trees at a specified level or all levels.</span>

<span class="sd">        :param level: The level of the tree to print. If None, all levels are printed.</span>
<span class="sd">        :type level: int, optional</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">level</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">tree</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trees</span><span class="p">:</span>
                <span class="n">tree</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">idhidden</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">level</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">level</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">LEVELS</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_trees</span><span class="p">[</span><span class="n">level</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">idhidden</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="Genome.get_genome_from_starting_point">
<a class="viewcode-back" href="../../core.html#core.genome.Genome.get_genome_from_starting_point">[docs]</a>
    <span class="k">def</span> <span class="nf">get_genome_from_starting_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the subtree of the genome starting from a specified node.</span>

<span class="sd">        :param node_id: The identifier of the node from which to start the subtree retrieval.</span>
<span class="sd">        :type node_id: str</span>
<span class="sd">        :return: A list containing the subtree from the starting node and the other trees.</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">trees</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_trees</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">trees</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_trees</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">subtree</span><span class="p">(</span><span class="n">nid</span><span class="o">=</span><span class="n">node_id</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">trees</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_trees</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">trees</span></div>


<div class="viewcode-block" id="Genome.get_left_child_genome">
<a class="viewcode-back" href="../../core.html#core.genome.Genome.get_left_child_genome">[docs]</a>
    <span class="k">def</span> <span class="nf">get_left_child_genome</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the genome structure starting from the left child of the root node.</span>

<span class="sd">        :return: A list containing the subtree from the left child and the other trees.</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trees</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">root</span>

        <span class="n">left_child</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trees</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">children</span><span class="p">(</span><span class="n">root</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">identifier</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_genome_from_starting_point</span><span class="p">(</span><span class="n">left_child</span><span class="p">)</span></div>


<div class="viewcode-block" id="Genome.get_right_child_genome">
<a class="viewcode-back" href="../../core.html#core.genome.Genome.get_right_child_genome">[docs]</a>
    <span class="k">def</span> <span class="nf">get_right_child_genome</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the genome structure starting from the right child of the root node.</span>

<span class="sd">        :return: A list containing the subtree from the right child and the other trees.</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trees</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">root</span>

        <span class="n">right_child</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trees</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">children</span><span class="p">(</span><span class="n">root</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">identifier</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_genome_from_starting_point</span><span class="p">(</span><span class="n">right_child</span><span class="p">)</span></div>


<div class="viewcode-block" id="Genome.get_root_symbol">
<a class="viewcode-back" href="../../core.html#core.genome.Genome.get_root_symbol">[docs]</a>
    <span class="k">def</span> <span class="nf">get_root_symbol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the symbol of the root node.</span>

<span class="sd">        :return: The symbol of the root node in the first tree.</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trees</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_trees</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">root</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span></div>


<div class="viewcode-block" id="Genome.jump">
<a class="viewcode-back" href="../../core.html#core.genome.Genome.jump">[docs]</a>
    <span class="k">def</span> <span class="nf">jump</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cuts off the first level of the genome and adds a new tree.</span>

<span class="sd">        :return: A list containing the remaining trees and the newly created tree.</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">()</span>
        <span class="n">tree</span><span class="o">.</span><span class="n">create_node</span><span class="p">(</span>
            <span class="n">tag</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">STARTING_SYMBOL</span><span class="p">,</span>
            <span class="n">identifier</span><span class="o">=</span><span class="n">GlobalCounter</span><span class="o">.</span><span class="n">next</span><span class="p">(),</span>
            <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trees</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="p">[</span><span class="n">tree</span><span class="p">]</span></div>


<div class="viewcode-block" id="Genome.get_trees">
<a class="viewcode-back" href="../../core.html#core.genome.Genome.get_trees">[docs]</a>
    <span class="k">def</span> <span class="nf">get_trees</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the genome&#39;s tree structure.</span>

<span class="sd">        :return: A list of all trees within the genome.</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trees</span></div>


<div class="viewcode-block" id="Genome.get_levels">
<a class="viewcode-back" href="../../core.html#core.genome.Genome.get_levels">[docs]</a>
    <span class="k">def</span> <span class="nf">get_levels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the number of levels in the genome.</span>

<span class="sd">        :return: The total number of levels in the genome.</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">LEVELS</span></div>


    <span class="c1"># * Get the tree at a specific level</span>
<div class="viewcode-block" id="Genome.get_tree">
<a class="viewcode-back" href="../../core.html#core.genome.Genome.get_tree">[docs]</a>
    <span class="k">def</span> <span class="nf">get_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the tree at a specific level.</span>

<span class="sd">        :param level: The level of the tree to retrieve.</span>
<span class="sd">        :type level: int</span>
<span class="sd">        :return: The tree at the specified level.</span>
<span class="sd">        :rtype: Tree</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trees</span><span class="p">[</span><span class="n">level</span><span class="p">]</span></div>


    <span class="c1"># * Update the identifiers of the nodes</span>
<div class="viewcode-block" id="Genome.update_ids">
<a class="viewcode-back" href="../../core.html#core.genome.Genome.update_ids">[docs]</a>
    <span class="k">def</span> <span class="nf">update_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the identifiers of all nodes in the genome&#39;s trees.</span>

<span class="sd">        This method assigns new unique identifiers to all nodes in each tree of the genome.</span>

<span class="sd">        :return: None</span>
<span class="sd">        :rtype: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">tree</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trees</span><span class="p">:</span>
            <span class="n">node_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">identifier</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">tree</span><span class="o">.</span><span class="n">all_nodes_itr</span><span class="p">()]</span>
            <span class="k">for</span> <span class="n">node_id</span> <span class="ow">in</span> <span class="n">node_ids</span><span class="p">:</span>
                <span class="n">tree</span><span class="o">.</span><span class="n">update_node</span><span class="p">(</span><span class="n">node_id</span><span class="p">,</span> <span class="n">identifier</span><span class="o">=</span><span class="n">GlobalCounter</span><span class="o">.</span><span class="n">next</span><span class="p">())</span></div>


<div class="viewcode-block" id="Genome.json_pickle">
<a class="viewcode-back" href="../../core.html#core.genome.Genome.json_pickle">[docs]</a>
    <span class="k">def</span> <span class="nf">json_pickle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Serializes the genome data using pickle.</span>

<span class="sd">        :return: A dictionary containing the pickled representation of the genome and parent information.</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        :example: </span>
<span class="sd">            &gt;&gt;&gt; genome.json_pickle()</span>
<span class="sd">            &gt;&gt;&gt; # {&#39;genome&#39;: [&#39;...&#39;, &#39;...&#39;, &#39;...&#39;], &#39;parents&#39;: None}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">encoded_trees</span> <span class="o">=</span> <span class="p">[</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span> <span class="k">for</span> <span class="n">tree</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trees</span><span class="p">]</span>
        <span class="n">encoded_trees</span> <span class="o">=</span> <span class="p">[</span><span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span>
            <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">tree</span> <span class="ow">in</span> <span class="n">encoded_trees</span><span class="p">]</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;genome&quot;</span><span class="p">:</span> <span class="n">encoded_trees</span><span class="p">,</span>
            <span class="s2">&quot;parents&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parents</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="Genome.from_json_pickle">
<a class="viewcode-back" href="../../core.html#core.genome.Genome.from_json_pickle">[docs]</a>
    <span class="k">def</span> <span class="nf">from_json_pickle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_individual</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deserializes the genome data from a pickled format.</span>

<span class="sd">        :param json_individual: A dictionary containing the pickled representation of the genome and parent information.</span>
<span class="sd">        :type json_individual: dict</span>
<span class="sd">        :return: None</span>
<span class="sd">        :rtype: Noneß</span>
<span class="sd">        :example: </span>
<span class="sd">            &gt;&gt;&gt; genome.from_json_pickle({&#39;genome&#39;: [&#39;...&#39;, &#39;...&#39;, &#39;...&#39;], &#39;parents&#39;: None})</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_trees</span> <span class="o">=</span> <span class="p">[</span><span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
                       <span class="k">for</span> <span class="n">tree</span> <span class="ow">in</span> <span class="n">json_individual</span><span class="p">[</span><span class="s1">&#39;genome&#39;</span><span class="p">]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_trees</span> <span class="o">=</span> <span class="p">[</span><span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
                       <span class="k">for</span> <span class="n">tree</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trees</span><span class="p">]</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Giacomo Vassallo.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>