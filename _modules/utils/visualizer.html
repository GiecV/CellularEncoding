

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>utils.visualizer &mdash; Cellular Encoding 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=01f34227"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Cellular Encoding
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">Modules</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Cellular Encoding</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">utils.visualizer</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for utils.visualizer</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">core.phenotype</span><span class="w"> </span><span class="kn">import</span> <span class="n">Phenotype</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">core.neural_network_from_graph</span><span class="w"> </span><span class="kn">import</span> <span class="n">NNFromGraph</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">core.genome</span><span class="w"> </span><span class="kn">import</span> <span class="n">Genome</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">networkx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nx</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">defaultdict</span><span class="p">,</span> <span class="n">deque</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.gridspec</span><span class="w"> </span><span class="kn">import</span> <span class="n">GridSpec</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>


<div class="viewcode-block" id="Visualizer">
<a class="viewcode-back" href="../../utils.html#utils.visualizer.Visualizer">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Visualizer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class for visualizing neural networks, phenotypes, and evolutionary runs.</span>

<span class="sd">    This class provides methods to visualize neural network structures, the</span>
<span class="sd">    phenotype of individuals, and data from evolutionary runs. It supports</span>
<span class="sd">    various types of plots including network graphs, tree visualizations,</span>
<span class="sd">    and fitness over time.</span>

<span class="sd">    :param inputs: The number of input nodes in the neural network. Default is 2.</span>
<span class="sd">    :type inputs: int, optional</span>
<span class="sd">    :param outputs: The number of output nodes in the neural network. Default is 1.</span>
<span class="sd">    :type outputs: int, optional</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the Visualizer with the number of inputs and outputs.</span>

<span class="sd">        :param inputs: The number of input nodes. Default is 2.</span>
<span class="sd">        :type inputs: int, optional</span>
<span class="sd">        :param outputs: The number of output nodes. Default is 1.</span>
<span class="sd">        :type outputs: int, optional</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="n">outputs</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_node_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">structure</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the positions of nodes in the neural network graph.</span>

<span class="sd">        :param structure: The graph structure of the neural network.</span>
<span class="sd">        :type structure: networkx.DiGraph</span>
<span class="sd">        :return: A dictionary mapping nodes to their positions.</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">start_nodes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">node</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">structure</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;I&quot;</span><span class="p">)]</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">start_nodes</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">)</span>
               <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">start_nodes</span><span class="p">)}</span>

        <span class="n">levels</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="n">queue</span> <span class="o">=</span> <span class="n">deque</span><span class="p">((</span><span class="n">node</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">start_nodes</span><span class="p">)</span>
        <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="k">while</span> <span class="n">queue</span><span class="p">:</span>
            <span class="n">node</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
                <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                <span class="n">levels</span><span class="p">[</span><span class="n">level</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                <span class="n">queue</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="n">successor</span><span class="p">,</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                             <span class="k">for</span> <span class="n">successor</span> <span class="ow">in</span> <span class="n">structure</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>

        <span class="n">pos</span> <span class="o">|=</span> <span class="p">{</span>
            <span class="n">node</span><span class="p">:</span> <span class="p">(</span>
                <span class="n">i</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                <span class="mf">0.0</span> <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;O&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="mi">1</span> <span class="o">-</span>
                <span class="p">(</span><span class="n">level</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)),</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">level</span><span class="p">,</span> <span class="n">nodes</span> <span class="ow">in</span> <span class="n">levels</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">pos</span>

<div class="viewcode-block" id="Visualizer.print_innovative_networks">
<a class="viewcode-back" href="../../utils.html#utils.visualizer.Visualizer.print_innovative_networks">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">print_innovative_networks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">innovative_individuals</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print and optionally save the innovative neural networks.</span>

<span class="sd">        :param innovative_individuals: A list of innovative individuals.</span>
<span class="sd">        :type innovative_individuals: list</span>
<span class="sd">        :param save: Whether to save the plots. Default is False.</span>
<span class="sd">        :type save: bool, optional</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">num_individuals</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">innovative_individuals</span><span class="p">)</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="n">num_individuals</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># 1 for NN + 3 for trees</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">rows</span> <span class="o">*</span> <span class="mi">6</span><span class="p">))</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">individual</span><span class="p">,</span> <span class="n">fitness_score</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">innovative_individuals</span><span class="p">):</span>
            <span class="n">phenotype</span> <span class="o">=</span> <span class="n">Phenotype</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>
            <span class="n">nn</span> <span class="o">=</span> <span class="n">NNFromGraph</span><span class="p">(</span><span class="n">phenotype</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span>
                             <span class="n">outputs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">)</span>

            <span class="c1"># Neural network plot (col 0)</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_node_positions</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">phenotype</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span>
            <span class="n">node_labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">node</span><span class="si">}</span><span class="s2">[</span><span class="si">{</span><span class="n">nn</span><span class="o">.</span><span class="n">phenotype</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span>
                           <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nn</span><span class="o">.</span><span class="n">phenotype</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">nodes</span><span class="p">}</span>

            <span class="n">ax_nn</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
            <span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">phenotype</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">node_labels</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
                    <span class="n">node_color</span><span class="o">=</span><span class="s2">&quot;skyblue&quot;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">font_weight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">arrows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_nn</span><span class="p">)</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">phenotype</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">)</span>
            <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span>
                <span class="n">nn</span><span class="o">.</span><span class="n">phenotype</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">edge_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_nn</span><span class="p">)</span>
            <span class="n">ax_nn</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Fitness Score: </span><span class="si">{</span><span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fitness_score</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="c1"># Genome: visualizing 3 trees (cols 1, 2, 3)</span>
            <span class="n">genome</span> <span class="o">=</span> <span class="n">individual</span><span class="o">.</span><span class="n">get_trees</span><span class="p">()</span>  <span class="c1"># Assuming the genome is a list of 3 trees</span>
            <span class="k">for</span> <span class="n">tree_idx</span><span class="p">,</span> <span class="n">tree</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">genome</span><span class="p">):</span>
                <span class="c1"># tree_idx + 1 to skip the NN column</span>
                <span class="n">ax_tree</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">tree_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>

                <span class="n">node_labels</span> <span class="o">=</span> <span class="p">{}</span>

                <span class="c1"># Convert treelib tree to NetworkX graph</span>
                <span class="n">tree_graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treelib_to_nx</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">node_labels</span><span class="p">)</span>

                <span class="c1"># Layout for tree graph</span>
                <span class="n">tree_pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">bfs_layout</span><span class="p">(</span>
                    <span class="n">tree_graph</span><span class="p">,</span> <span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
                <span class="n">max_y</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">tree_pos</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
                <span class="n">tree_pos</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">max_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tree_pos</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

                <span class="c1"># Plot the tree as a NetworkX graph</span>
                <span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">tree_graph</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">tree_pos</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">node_labels</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="s2">&quot;lightgreen&quot;</span><span class="p">,</span>
                        <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">font_weight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">arrows</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_tree</span><span class="p">)</span>
                <span class="n">ax_tree</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Tree </span><span class="si">{</span><span class="n">tree_idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_file_with_name</span><span class="p">(</span><span class="s1">&#39;innovative_networks_&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="Visualizer.treelib_to_nx">
<a class="viewcode-back" href="../../utils.html#utils.visualizer.Visualizer.treelib_to_nx">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">treelib_to_nx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tree</span><span class="p">,</span> <span class="n">node_labels</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert a tree structure from treelib to a NetworkX directed graph.</span>

<span class="sd">        :param tree: The tree structure to convert.</span>
<span class="sd">        :type tree: treelib.Tree</span>
<span class="sd">        :param node_labels: A dictionary to store node labels.</span>
<span class="sd">        :type node_labels: dict</span>
<span class="sd">        :return: The converted directed graph.</span>
<span class="sd">        :rtype: networkx.DiGraph</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>  <span class="c1"># Create a directed graph</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">add_edges</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
            <span class="c1"># Use children() to get the child nodes</span>
            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">tree</span><span class="o">.</span><span class="n">children</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">identifier</span><span class="p">):</span>
                <span class="c1"># Add edge from parent to child</span>
                <span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">identifier</span><span class="p">,</span> <span class="n">child</span><span class="o">.</span><span class="n">identifier</span><span class="p">)</span>
                <span class="n">node_labels</span><span class="p">[</span><span class="n">child</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">tag</span>
                <span class="n">add_edges</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>  <span class="c1"># Recurse on the child node</span>

        <span class="c1"># Start the recursive process from the root</span>
        <span class="n">node_labels</span><span class="p">[</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">]</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span>
        <span class="n">add_edges</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">root_node</span> <span class="o">=</span> <span class="n">tree</span><span class="p">[</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">]</span>
            <span class="n">node_labels</span><span class="p">[</span><span class="n">root_node</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">root_node</span><span class="o">.</span><span class="n">tag</span>
            <span class="n">graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">root_node</span><span class="o">.</span><span class="n">identifier</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">graph</span></div>


<div class="viewcode-block" id="Visualizer.print_population">
<a class="viewcode-back" href="../../utils.html#utils.visualizer.Visualizer.print_population">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">print_population</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">population</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print the details of each individual in the population.</span>

<span class="sd">        :param population: A list of individuals in the population.</span>
<span class="sd">        :type population: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">individual</span> <span class="ow">in</span> <span class="n">population</span><span class="p">:</span>
            <span class="n">individual</span><span class="o">.</span><span class="n">print</span><span class="p">()</span></div>


<div class="viewcode-block" id="Visualizer.print_phenotype">
<a class="viewcode-back" href="../../utils.html#utils.visualizer.Visualizer.print_phenotype">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">print_phenotype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phenotype</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print and optionally save the phenotype structure.</span>

<span class="sd">        :param phenotype: The phenotype to print.</span>
<span class="sd">        :type phenotype: Phenotype</span>
<span class="sd">        :param save: Whether to save the plot. Default is False.</span>
<span class="sd">        :type save: bool, optional</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_node_positions</span><span class="p">(</span><span class="n">phenotype</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span>

            <span class="n">node_labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">node</span><span class="si">}</span><span class="s2">[</span><span class="si">{</span><span class="n">phenotype</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span>
                           <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">phenotype</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">nodes</span><span class="p">}</span>

            <span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span>
                <span class="n">phenotype</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span>
                <span class="n">pos</span><span class="p">,</span>
                <span class="n">labels</span><span class="o">=</span><span class="n">node_labels</span><span class="p">,</span>
                <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">node_size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
                <span class="n">node_color</span><span class="o">=</span><span class="s2">&quot;skyblue&quot;</span><span class="p">,</span>
                <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                <span class="n">font_weight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span>
                <span class="n">arrows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">phenotype</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">)</span>
            <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span>
                <span class="n">phenotype</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">edge_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">save_file_with_name</span><span class="p">(</span><span class="s1">&#39;phenotype_&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cannot set positions&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">print_no_position</span><span class="p">(</span><span class="n">phenotype</span><span class="p">)</span></div>


<div class="viewcode-block" id="Visualizer.save_file_with_name">
<a class="viewcode-back" href="../../utils.html#utils.visualizer.Visualizer.save_file_with_name">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">save_file_with_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save the current plot with a given name.</span>

<span class="sd">        :param name: The base name for the file to save.</span>
<span class="sd">        :type name: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s1">&#39;img&#39;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">_%H%M%S&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;img&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}{</span><span class="n">timestamp</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">))</span></div>


<div class="viewcode-block" id="Visualizer.print_no_position">
<a class="viewcode-back" href="../../utils.html#utils.visualizer.Visualizer.print_no_position">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">print_no_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phenotype</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print the phenotype without positioning information.</span>

<span class="sd">        :param phenotype: The phenotype to print.</span>
<span class="sd">        :type phenotype: Phenotype</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">phenotype</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="Visualizer.plot_all_runs">
<a class="viewcode-back" href="../../utils.html#utils.visualizer.Visualizer.plot_all_runs">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_all_runs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_file_path</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the fitness of all runs from a JSON file.</span>

<span class="sd">        :param json_file_path: The path to the JSON file containing the run data.</span>
<span class="sd">        :type json_file_path: str</span>
<span class="sd">        :param save: Whether to save the plot. Default is False.</span>
<span class="sd">        :type save: bool, optional</span>
<span class="sd">        :raises FileNotFoundError: If the JSON file does not exist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">json_file_path</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The file </span><span class="si">{</span><span class="n">json_file_path</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">json_file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

            <span class="n">scores</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">inputs</span> <span class="o">=</span> <span class="n">run</span><span class="p">[</span><span class="s1">&#39;inputs&#39;</span><span class="p">]</span>
                <span class="n">iteration</span> <span class="o">=</span> <span class="n">run</span><span class="p">[</span><span class="s1">&#39;iteration&#39;</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">iteration</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">scores</span><span class="p">:</span>
                    <span class="n">scores</span><span class="p">[</span><span class="n">iteration</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">for</span> <span class="n">generation</span> <span class="ow">in</span> <span class="n">run</span><span class="p">[</span><span class="s1">&#39;log&#39;</span><span class="p">]:</span>

                    <span class="n">fitness</span> <span class="o">=</span> <span class="n">generation</span><span class="p">[</span><span class="s1">&#39;best_score&#39;</span><span class="p">]</span>
                    <span class="n">scores</span><span class="p">[</span><span class="n">iteration</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fitness</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">iteration</span><span class="p">,</span> <span class="n">fitness_values</span> <span class="ow">in</span> <span class="n">scores</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fitness_values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Run </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Generation&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fitness&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Fitness, 10 Runs&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_file_with_name</span><span class="p">(</span><span class="s1">&#39;runs_&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="Visualizer.plot_all_times">
<a class="viewcode-back" href="../../utils.html#utils.visualizer.Visualizer.plot_all_times">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_all_times</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_file_path</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the fitness of all runs from a JSON file.</span>

<span class="sd">        :param json_file_path: The path to the JSON file containing the run data.</span>
<span class="sd">        :type json_file_path: str</span>
<span class="sd">        :param save: Whether to save the plot. Default is False.</span>
<span class="sd">        :type save: bool, optional</span>
<span class="sd">        :raises FileNotFoundError: If the JSON file does not exist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">json_file_path</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The file </span><span class="si">{</span><span class="n">json_file_path</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">json_file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

            <span class="n">scores</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">inputs</span> <span class="o">=</span> <span class="n">run</span><span class="p">[</span><span class="s1">&#39;inputs&#39;</span><span class="p">]</span>
                <span class="n">iteration</span> <span class="o">=</span> <span class="n">run</span><span class="p">[</span><span class="s1">&#39;iteration&#39;</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">iteration</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">scores</span><span class="p">:</span>
                    <span class="n">scores</span><span class="p">[</span><span class="n">iteration</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">for</span> <span class="n">generation</span> <span class="ow">in</span> <span class="n">run</span><span class="p">[</span><span class="s1">&#39;log&#39;</span><span class="p">]:</span>

                    <span class="n">fitness</span> <span class="o">=</span> <span class="n">generation</span><span class="p">[</span><span class="s1">&#39;generation_time&#39;</span><span class="p">]</span>
                    <span class="n">scores</span><span class="p">[</span><span class="n">iteration</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fitness</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">iteration</span><span class="p">,</span> <span class="n">fitness_values</span> <span class="ow">in</span> <span class="n">scores</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fitness_values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Run </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Generation&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Time, 10 Runs&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_file_with_name</span><span class="p">(</span><span class="s1">&#39;runs_&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="Visualizer.save_lineage">
<a class="viewcode-back" href="../../utils.html#utils.visualizer.Visualizer.save_lineage">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">save_lineage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_path</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print and optionally save the innovative neural networks.</span>

<span class="sd">        :param json_path: Path to the JSON file containing lineage data.</span>
<span class="sd">        :type json_path: str</span>
<span class="sd">        :param show: Whether to display the plots. Defaults to False.</span>
<span class="sd">        :type show: bool, optional</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">json_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">json_file</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

        <span class="n">cols</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># 1 for NN + 3 for trees</span>

        <span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="n">json_file</span><span class="p">:</span>
            <span class="n">json_individuals</span> <span class="o">=</span> <span class="n">run</span><span class="p">[</span><span class="s1">&#39;lineage&#39;</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">individual</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">json_individuals</span><span class="p">):</span>
                <span class="n">genome</span> <span class="o">=</span> <span class="n">Genome</span><span class="p">()</span>
                <span class="n">genome</span><span class="o">.</span><span class="n">from_json_pickle</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>
                <span class="n">json_individuals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">genome</span><span class="p">,</span> <span class="n">individual</span><span class="p">[</span><span class="s1">&#39;generation&#39;</span><span class="p">])</span>

            <span class="n">num_individuals</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">json_individuals</span><span class="p">)</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="n">num_individuals</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">rows</span> <span class="o">*</span> <span class="mi">6</span><span class="p">))</span>
            <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">individual</span><span class="p">,</span> <span class="n">generation</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">json_individuals</span><span class="p">):</span>
                <span class="n">phenotype</span> <span class="o">=</span> <span class="n">Phenotype</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>
                <span class="n">nn</span> <span class="o">=</span> <span class="n">NNFromGraph</span><span class="p">(</span><span class="n">phenotype</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">run</span><span class="p">[</span><span class="s1">&#39;inputs&#39;</span><span class="p">],</span>
                                 <span class="n">outputs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

                <span class="c1"># Neural network plot (col 0)</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_node_positions</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">phenotype</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span>
                <span class="n">node_labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">node</span><span class="si">}</span><span class="s2">[</span><span class="si">{</span><span class="n">nn</span><span class="o">.</span><span class="n">phenotype</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span>
                               <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nn</span><span class="o">.</span><span class="n">phenotype</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">nodes</span><span class="p">}</span>

                <span class="n">ax_nn</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
                <span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">phenotype</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">node_labels</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
                        <span class="n">node_color</span><span class="o">=</span><span class="s2">&quot;skyblue&quot;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">font_weight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">arrows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_nn</span><span class="p">)</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span>
                    <span class="n">nn</span><span class="o">.</span><span class="n">phenotype</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">)</span>
                <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span>
                    <span class="n">nn</span><span class="o">.</span><span class="n">phenotype</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">edge_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_nn</span><span class="p">)</span>
                <span class="n">ax_nn</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Generation: </span><span class="si">{</span><span class="n">generation</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

                <span class="n">genome</span> <span class="o">=</span> <span class="n">individual</span><span class="o">.</span><span class="n">get_trees</span><span class="p">()</span>  <span class="c1"># Assuming the genome is a list of 3 trees</span>
                <span class="k">for</span> <span class="n">tree_idx</span><span class="p">,</span> <span class="n">tree</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">genome</span><span class="p">):</span>
                    <span class="c1"># tree_idx + 1 to skip the NN column</span>
                    <span class="n">ax_tree</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">tree_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>

                    <span class="n">node_labels</span> <span class="o">=</span> <span class="p">{}</span>

                    <span class="c1"># Convert treelib tree to NetworkX graph</span>
                    <span class="n">tree_graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treelib_to_nx</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">node_labels</span><span class="p">)</span>

                    <span class="c1"># Layout for tree graph</span>
                    <span class="n">tree_pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">bfs_layout</span><span class="p">(</span>
                        <span class="n">tree_graph</span><span class="p">,</span> <span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
                    <span class="n">max_y</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">tree_pos</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
                    <span class="n">tree_pos</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">max_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span>
                                <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tree_pos</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

                    <span class="c1"># Plot the tree as a NetworkX graph</span>
                    <span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">tree_graph</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">tree_pos</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">node_labels</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="s2">&quot;lightgreen&quot;</span><span class="p">,</span>
                            <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">font_weight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">arrows</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_tree</span><span class="p">)</span>
                    <span class="n">ax_tree</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Tree </span><span class="si">{</span><span class="n">tree_idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_file_with_name</span><span class="p">(</span><span class="s1">&#39;innovative_networks_&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="Visualizer.plot_times">
<a class="viewcode-back" href="../../utils.html#utils.visualizer.Visualizer.plot_times">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_times</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_file_paths</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the time taken for each generation for multiple JSON files.</span>

<span class="sd">        :param json_file_paths: A list of paths to JSON files.</span>
<span class="sd">        :type json_file_paths: list of str</span>
<span class="sd">        :param save: Whether to save the plot. Defaults to False.</span>
<span class="sd">        :type save: bool, optional</span>
<span class="sd">        :raises ValueError: If `json_file_paths` is not a list of file paths.</span>
<span class="sd">        :raises FileNotFoundError: If any of the specified JSON files do not exist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">json_file_paths</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;json_file_paths should be a list of file paths.&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">json_file_path</span> <span class="ow">in</span> <span class="n">json_file_paths</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">json_file_path</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;The file </span><span class="si">{</span><span class="n">json_file_path</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">json_file_path</span> <span class="ow">in</span> <span class="n">json_file_paths</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">json_file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

            <span class="n">scores</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">inputs</span> <span class="o">=</span> <span class="n">run</span><span class="p">[</span><span class="s1">&#39;inputs&#39;</span><span class="p">]</span>
                <span class="n">iteration</span> <span class="o">=</span> <span class="n">run</span><span class="p">[</span><span class="s1">&#39;iteration&#39;</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">iteration</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">scores</span><span class="p">:</span>
                    <span class="n">scores</span><span class="p">[</span><span class="n">iteration</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">for</span> <span class="n">generation</span> <span class="ow">in</span> <span class="n">run</span><span class="p">[</span><span class="s1">&#39;log&#39;</span><span class="p">]:</span>
                    <span class="n">time</span> <span class="o">=</span> <span class="n">generation</span><span class="p">[</span><span class="s1">&#39;generation_time&#39;</span><span class="p">]</span>
                    <span class="n">scores</span><span class="p">[</span><span class="n">iteration</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>

            <span class="n">max_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fitness_values</span><span class="p">)</span>
                             <span class="k">for</span> <span class="n">fitness_values</span> <span class="ow">in</span> <span class="n">scores</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="n">scores</span><span class="p">:</span>
                <span class="n">last_value</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">scores</span><span class="p">[</span><span class="n">iteration</span><span class="p">][</span><span class="o">-</span><span class="mi">5</span><span class="p">:])</span> <span class="o">/</span> <span class="mi">5</span>
                <span class="n">scores</span><span class="p">[</span><span class="n">iteration</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">last_value</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">max_length</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">scores</span><span class="p">[</span><span class="n">iteration</span><span class="p">])))</span>

            <span class="n">avg_time</span> <span class="o">=</span> <span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">scores</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_length</span><span class="p">)]</span>
            <span class="n">std_dev</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">([</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">scores</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
                       <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_length</span><span class="p">)]</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">avg_time</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">json_file_path</span><span class="p">))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">max_length</span><span class="p">),</span>
                             <span class="p">[</span><span class="n">avg_time</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">std_dev</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                 <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_length</span><span class="p">)],</span>
                             <span class="p">[</span><span class="n">avg_time</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">std_dev</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                 <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_length</span><span class="p">)],</span>
                             <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_length</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Generation&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Average Time (s)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Average Time per Generation&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_file_with_name</span><span class="p">(</span><span class="s1">&#39;runs_&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="Visualizer.plot_avg_fitness">
<a class="viewcode-back" href="../../utils.html#utils.visualizer.Visualizer.plot_avg_fitness">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_avg_fitness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_file_paths</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the average fitness over generations with standard deviation for multiple JSON files.</span>

<span class="sd">        :param json_file_paths: A list of paths to JSON files.</span>
<span class="sd">        :type json_file_paths: list of str</span>
<span class="sd">        :param save: Whether to save the plot. Defaults to False.</span>
<span class="sd">        :type save: bool, optional</span>
<span class="sd">        :raises ValueError: If `json_file_paths` is not a list of file paths.</span>
<span class="sd">        :raises FileNotFoundError: If any of the specified JSON files do not exist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">json_file_paths</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;json_file_paths should be a list of file paths.&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">json_file_path</span> <span class="ow">in</span> <span class="n">json_file_paths</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">json_file_path</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;The file </span><span class="si">{</span><span class="n">json_file_path</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">json_file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

            <span class="n">scores</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">inputs</span> <span class="o">=</span> <span class="n">run</span><span class="p">[</span><span class="s1">&#39;inputs&#39;</span><span class="p">]</span>
                <span class="n">iteration</span> <span class="o">=</span> <span class="n">run</span><span class="p">[</span><span class="s1">&#39;iteration&#39;</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">iteration</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">scores</span><span class="p">:</span>
                    <span class="n">scores</span><span class="p">[</span><span class="n">iteration</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">for</span> <span class="n">generation</span> <span class="ow">in</span> <span class="n">run</span><span class="p">[</span><span class="s1">&#39;log&#39;</span><span class="p">]:</span>
                    <span class="n">fitness</span> <span class="o">=</span> <span class="n">generation</span><span class="p">[</span><span class="s1">&#39;best_score&#39;</span><span class="p">]</span>
                    <span class="n">scores</span><span class="p">[</span><span class="n">iteration</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fitness</span><span class="p">)</span>

            <span class="n">max_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fitness_values</span><span class="p">)</span>
                             <span class="k">for</span> <span class="n">fitness_values</span> <span class="ow">in</span> <span class="n">scores</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="n">scores</span><span class="p">:</span>
                <span class="n">last_value</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="n">iteration</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">scores</span><span class="p">[</span><span class="n">iteration</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">last_value</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">max_length</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">scores</span><span class="p">[</span><span class="n">iteration</span><span class="p">])))</span>

            <span class="n">avg_fitness</span> <span class="o">=</span> <span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">fitness_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">fitness_values</span> <span class="ow">in</span> <span class="n">scores</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
                           <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_length</span><span class="p">)]</span>
            <span class="n">std_dev</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">([</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">scores</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
                       <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_length</span><span class="p">)]</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">avg_fitness</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">json_file_path</span><span class="p">))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">max_length</span><span class="p">),</span>
                             <span class="p">[</span><span class="n">avg_fitness</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">std_dev</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                 <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_length</span><span class="p">)],</span>
                             <span class="p">[</span><span class="n">avg_fitness</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">std_dev</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                 <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_length</span><span class="p">)],</span>
                             <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Generation&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fitness&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Average Fitness per Generation&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_file_with_name</span><span class="p">(</span><span class="s1">&#39;fitness_multiple_files_&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="Visualizer.create_boxplots">
<a class="viewcode-back" href="../../utils.html#utils.visualizer.Visualizer.create_boxplots">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_boxplots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_file_paths</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates boxplots to visualize the average number of generations required to achieve optimal results across different input configurations from multiple JSON files. This method aggregates data from the specified JSON files and generates a bar plot with error bars representing the standard deviation.</span>

<span class="sd">        :param json_file_paths: A list of paths to the JSON files containing the data.</span>
<span class="sd">        :type json_file_paths: list of str</span>
<span class="sd">        :param save: If True, saves the generated plot to a file. Defaults to False.</span>
<span class="sd">        :type save: bool</span>
<span class="sd">        :raises FileNotFoundError: If any of the specified JSON files do not exist.</span>
<span class="sd">        :examples:</span>
<span class="sd">            &gt;&gt;&gt; Visualizer.create_boxplots([&#39;logs/6i.json&#39;, &#39;logs/36i.json&#39;], save=True)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">all_data</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">json_file_path</span> <span class="ow">in</span> <span class="n">json_file_paths</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">json_file_path</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;The file </span><span class="si">{</span><span class="n">json_file_path</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">json_file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="n">all_data</span><span class="p">[</span><span class="n">json_file_path</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                    <span class="n">inputs</span> <span class="o">=</span> <span class="n">run</span><span class="p">[</span><span class="s1">&#39;inputs&#39;</span><span class="p">]</span>
                    <span class="n">generations</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">run</span><span class="p">[</span><span class="s1">&#39;log&#39;</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">inputs</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">[</span><span class="n">json_file_path</span><span class="p">]:</span>
                        <span class="n">all_data</span><span class="p">[</span><span class="n">json_file_path</span><span class="p">][</span><span class="n">inputs</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">all_data</span><span class="p">[</span><span class="n">json_file_path</span><span class="p">][</span><span class="n">inputs</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">generations</span><span class="p">)</span>

        <span class="n">color_map</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;logs/6i.json&#39;</span><span class="p">:</span> <span class="s1">&#39;#d9e7dc&#39;</span><span class="p">,</span> <span class="s1">&#39;logs/36i.json&#39;</span><span class="p">:</span> <span class="s1">&#39;#eb3e56&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;logs/23456i.json&#39;</span><span class="p">:</span> <span class="s1">&#39;#8296b5&#39;</span><span class="p">}</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1 stage&#39;</span><span class="p">,</span> <span class="s1">&#39;2 stages&#39;</span><span class="p">,</span> <span class="s1">&#39;5 stages&#39;</span><span class="p">]</span>

        <span class="c1"># Prepare figure and axes</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

        <span class="n">sorted_keys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
            <span class="p">{</span><span class="n">key</span> <span class="k">for</span> <span class="n">sub_data</span> <span class="ow">in</span> <span class="n">all_data</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">sub_data</span><span class="p">}</span>
        <span class="p">)</span>

        <span class="c1"># Set a position counter for each bar</span>
        <span class="n">current_pos</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Starting position for bar plots</span>
        <span class="n">x_positions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">x_labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="mf">0.35</span>

        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">sorted_keys</span><span class="p">:</span>
            <span class="n">bar_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">key</span> <span class="ow">in</span> <span class="n">sub_data</span> <span class="k">for</span> <span class="n">sub_data</span> <span class="ow">in</span> <span class="n">all_data</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="n">pos_offset</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">bar_count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">offset</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="k">for</span> <span class="n">file</span><span class="p">,</span> <span class="n">sub_data</span> <span class="ow">in</span> <span class="n">all_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">sub_data</span><span class="p">:</span>
                    <span class="n">values</span> <span class="o">=</span> <span class="n">sub_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

                    <span class="n">mean_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
                    <span class="n">std_dev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

                    <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">current_pos</span> <span class="o">+</span> <span class="n">pos_offset</span><span class="p">,</span> <span class="n">mean_val</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">std_dev</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_map</span><span class="p">[</span><span class="n">file</span><span class="p">],</span>
                            <span class="n">width</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

                    <span class="c1"># Annotate each bar with mean  std deviation</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">current_pos</span> <span class="o">+</span> <span class="n">pos_offset</span><span class="p">,</span> <span class="n">mean_val</span> <span class="o">+</span> <span class="n">std_dev</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mean_val</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"></span><span class="si">{</span><span class="n">std_dev</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                             <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

                    <span class="c1"># Append x-axis position and corresponding key label</span>
            <span class="c1"># Only label the first bar in each group</span>
                    <span class="k">if</span> <span class="n">pos_offset</span> <span class="o">==</span> <span class="o">-</span><span class="p">(</span><span class="n">bar_count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">offset</span> <span class="o">/</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">x_positions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_pos</span><span class="p">)</span>
                        <span class="n">x_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

                    <span class="n">pos_offset</span> <span class="o">+=</span> <span class="n">offset</span>

                    <span class="c1"># Move to the next x position</span>
            <span class="n">current_pos</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x_positions</span><span class="p">,</span> <span class="n">x_labels</span><span class="p">)</span>

        <span class="n">handles</span> <span class="o">=</span> <span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color_map</span><span class="p">[</span><span class="n">file</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
                   <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">color_map</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Curriculums&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x_positions</span><span class="p">,</span> <span class="n">x_labels</span><span class="p">)</span>
        <span class="c1"># Custom legend and labels</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Inputs&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Avg Generations  Std Dev&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Average Generations to Achieve the Optimum at Each Stage&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_file_with_name</span><span class="p">(</span><span class="s1">&#39;boxplot_&#39;</span><span class="p">)</span>

        <span class="c1"># Show plot</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="Visualizer.compute_averages">
<a class="viewcode-back" href="../../utils.html#utils.visualizer.Visualizer.compute_averages">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_averages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_data</span><span class="p">):</span>
        <span class="n">averages</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">std_devs</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">file</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">all_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># Find the maximum length of the lists in the file</span>
            <span class="n">max_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="k">for</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

            <span class="c1"># Initialize a list to store the summed values</span>
            <span class="n">summed_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">max_length</span>

            <span class="c1"># Sum the values with different keys but the same index</span>
            <span class="k">for</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
                    <span class="n">summed_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">value</span>

            <span class="c1"># Compute the average for each index</span>
            <span class="n">averages</span><span class="p">[</span><span class="n">file</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">summed_values</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">summed_values</span><span class="p">)</span>
            <span class="n">std_devs</span><span class="p">[</span><span class="n">file</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">summed_values</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">averages</span><span class="p">,</span> <span class="n">std_devs</span></div>


<div class="viewcode-block" id="Visualizer.create_sum_boxplots">
<a class="viewcode-back" href="../../utils.html#utils.visualizer.Visualizer.create_sum_boxplots">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_sum_boxplots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_file_paths</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates boxplots to visualize the average number of generations required to achieve optimal results across different input configurations from multiple JSON files. This method aggregates data from the specified JSON files, computes averages and standard deviations, and creates a bar plot with error bars.</span>

<span class="sd">        :param json_file_paths: A list of paths to the JSON files containing the data.</span>
<span class="sd">        :type json_file_paths: list of str</span>
<span class="sd">        :param save: If True, saves the generated plot to a file. Defaults to False.</span>
<span class="sd">        :type save: bool</span>
<span class="sd">        :raises FileNotFoundError: If any of the specified JSON files do not exist.</span>
<span class="sd">        :examples:</span>
<span class="sd">            &gt;&gt;&gt; Visualizer.create_sum_boxplots([&#39;logs/6i.json&#39;, &#39;logs/36i.json&#39;], save=True)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">all_data</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">json_file_path</span> <span class="ow">in</span> <span class="n">json_file_paths</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">json_file_path</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;The file </span><span class="si">{</span><span class="n">json_file_path</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">json_file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="n">all_data</span><span class="p">[</span><span class="n">json_file_path</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                    <span class="n">inputs</span> <span class="o">=</span> <span class="n">run</span><span class="p">[</span><span class="s1">&#39;inputs&#39;</span><span class="p">]</span>
                    <span class="n">generations</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">run</span><span class="p">[</span><span class="s1">&#39;log&#39;</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">inputs</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">[</span><span class="n">json_file_path</span><span class="p">]:</span>
                        <span class="n">all_data</span><span class="p">[</span><span class="n">json_file_path</span><span class="p">][</span><span class="n">inputs</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">all_data</span><span class="p">[</span><span class="n">json_file_path</span><span class="p">][</span><span class="n">inputs</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">generations</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="n">all_data</span><span class="p">)</span>
        <span class="n">averages</span><span class="p">,</span> <span class="n">std_devs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_averages</span><span class="p">(</span><span class="n">all_data</span><span class="p">)</span>

        <span class="n">color_map</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;logs/6i.json&#39;</span><span class="p">:</span> <span class="s1">&#39;#d9e7dc&#39;</span><span class="p">,</span> <span class="s1">&#39;logs/36i.json&#39;</span><span class="p">:</span> <span class="s1">&#39;#eb3e56&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;logs/23456i.json&#39;</span><span class="p">:</span> <span class="s1">&#39;#8296b5&#39;</span><span class="p">}</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1 stage&#39;</span><span class="p">,</span> <span class="s1">&#39;2 stages&#39;</span><span class="p">,</span> <span class="s1">&#39;5 stages&#39;</span><span class="p">]</span>

        <span class="c1"># Prepare figure and axes</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

        <span class="n">current_pos</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">averages</span><span class="p">:</span>
            <span class="n">current_pos</span> <span class="o">+=</span> <span class="mf">0.35</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">current_pos</span><span class="p">,</span> <span class="n">averages</span><span class="p">[</span><span class="n">file</span><span class="p">],</span> <span class="n">yerr</span><span class="o">=</span><span class="n">std_devs</span><span class="p">[</span><span class="n">file</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color_map</span><span class="p">[</span><span class="n">file</span><span class="p">],</span>
                    <span class="n">width</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

            <span class="c1"># Annotate each bar with mean  std deviation</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">current_pos</span><span class="p">,</span> <span class="n">averages</span><span class="p">[</span><span class="n">file</span><span class="p">]</span> <span class="o">+</span> <span class="n">std_devs</span><span class="p">[</span><span class="n">file</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">averages</span><span class="p">[</span><span class="n">file</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"></span><span class="si">{</span><span class="n">std_devs</span><span class="p">[</span><span class="n">file</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                     <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

        <span class="n">handles</span> <span class="o">=</span> <span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color_map</span><span class="p">[</span><span class="n">file</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
                   <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">color_map</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Curriculums&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>

        <span class="c1"># Custom legend and labels</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Stages&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Avg Generations  Std Dev&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Average Generations to Achieve the Optimum&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_file_with_name</span><span class="p">(</span><span class="s1">&#39;boxplot_&#39;</span><span class="p">)</span>

        <span class="c1"># Show plot</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="n">averages</span><span class="p">,</span> <span class="n">std_devs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_averages</span><span class="p">(</span><span class="n">all_data</span><span class="p">)</span></div>


<div class="viewcode-block" id="Visualizer.save_best_networks">
<a class="viewcode-back" href="../../utils.html#utils.visualizer.Visualizer.save_best_networks">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">save_best_networks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_path</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves visual representations of the best neural networks and their associated trees from a JSON file. This method reads the JSON data, processes the neural networks and trees, and generates plots for each iteration.</span>

<span class="sd">        :param json_path: The path to the JSON file containing network data.</span>
<span class="sd">        :type json_path: str</span>
<span class="sd">        :param show: If True, displays the generated plots. Defaults to False.</span>
<span class="sd">        :type show: bool</span>
<span class="sd">        :returns: None</span>
<span class="sd">        :examples:</span>
<span class="sd">            &gt;&gt;&gt; Visualizer.save_best_networks(&#39;path/to/json_file.json&#39;, show=True)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">json_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">json_file</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

            <span class="n">cols</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># 1 for NN + 3 for trees</span>
            <span class="n">individuals</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="n">json_file</span><span class="p">:</span>
            <span class="n">json_individual</span> <span class="o">=</span> <span class="n">run</span><span class="p">[</span><span class="s1">&#39;lineage&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">genome</span> <span class="o">=</span> <span class="n">Genome</span><span class="p">()</span>
            <span class="n">genome</span><span class="o">.</span><span class="n">from_json_pickle</span><span class="p">(</span><span class="n">json_individual</span><span class="p">)</span>
            <span class="n">json_individual</span> <span class="o">=</span> <span class="n">genome</span>

            <span class="k">if</span> <span class="n">run</span><span class="p">[</span><span class="s1">&#39;iteration&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">individuals</span><span class="p">:</span>
                <span class="n">individuals</span><span class="p">[</span><span class="n">run</span><span class="p">[</span><span class="s1">&#39;iteration&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">individuals</span><span class="p">[</span><span class="n">run</span><span class="p">[</span><span class="s1">&#39;iteration&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">(</span><span class="n">run</span><span class="p">[</span><span class="s1">&#39;inputs&#39;</span><span class="p">],</span> <span class="n">json_individual</span><span class="p">))</span>

        <span class="n">num_individuals</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">individuals</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="n">num_individuals</span>

        <span class="k">for</span> <span class="n">iteration</span><span class="p">,</span> <span class="n">individuals_list</span> <span class="ow">in</span> <span class="n">individuals</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">rows</span> <span class="o">*</span> <span class="mi">6</span><span class="p">))</span>
            <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">ins</span><span class="p">,</span> <span class="n">individual</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">individuals_list</span><span class="p">):</span>
                <span class="n">phenotype</span> <span class="o">=</span> <span class="n">Phenotype</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>
                <span class="n">nn</span> <span class="o">=</span> <span class="n">NNFromGraph</span><span class="p">(</span><span class="n">phenotype</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">ins</span><span class="p">,</span>
                                 <span class="n">outputs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

                <span class="c1"># Neural network plot (col 0)</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_node_positions</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">phenotype</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span>
                <span class="n">node_labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">node</span><span class="si">}</span><span class="s2">[</span><span class="si">{</span><span class="n">nn</span><span class="o">.</span><span class="n">phenotype</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span>
                               <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nn</span><span class="o">.</span><span class="n">phenotype</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">nodes</span><span class="p">}</span>

                <span class="n">ax_nn</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
                <span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">phenotype</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">node_labels</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
                        <span class="n">node_color</span><span class="o">=</span><span class="s2">&quot;skyblue&quot;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">font_weight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">arrows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_nn</span><span class="p">)</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span>
                    <span class="n">nn</span><span class="o">.</span><span class="n">phenotype</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">)</span>
                <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span>
                    <span class="n">nn</span><span class="o">.</span><span class="n">phenotype</span><span class="o">.</span><span class="n">structure</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">edge_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_nn</span><span class="p">)</span>
                <span class="n">ax_nn</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Iteration: </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

                <span class="n">genome</span> <span class="o">=</span> <span class="n">individual</span><span class="o">.</span><span class="n">get_trees</span><span class="p">()</span>  <span class="c1"># Assuming the genome is a list of 3 trees</span>
                <span class="k">for</span> <span class="n">tree_idx</span><span class="p">,</span> <span class="n">tree</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">genome</span><span class="p">):</span>
                    <span class="c1"># tree_idx + 1 to skip the NN column</span>
                    <span class="n">ax_tree</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">tree_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>

                    <span class="n">node_labels</span> <span class="o">=</span> <span class="p">{}</span>

                    <span class="c1"># Convert treelib tree to NetworkX graph</span>
                    <span class="n">tree_graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treelib_to_nx</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">node_labels</span><span class="p">)</span>

                    <span class="c1"># Layout for tree graph</span>
                    <span class="n">tree_pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">bfs_layout</span><span class="p">(</span>
                        <span class="n">tree_graph</span><span class="p">,</span> <span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
                    <span class="n">max_y</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">tree_pos</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
                    <span class="n">tree_pos</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">max_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span>
                                <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tree_pos</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

                    <span class="c1"># Plot the tree as a NetworkX graph</span>
                    <span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">tree_graph</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">tree_pos</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">node_labels</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="s2">&quot;lightgreen&quot;</span><span class="p">,</span>
                            <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">font_weight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">arrows</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_tree</span><span class="p">)</span>
                    <span class="n">ax_tree</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Tree </span><span class="si">{</span><span class="n">tree_idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_file_with_name</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;champions_</span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Giacomo Vassallo.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>